<form [formGroup]="registerForm" (ngSubmit)="register()" autocomplete="off" [class.disabled-form]="isUploading">
  <h2 class="text-center text-primary">Оголошення про тваринку</h2>
  <hr />

  <!-- Animal Info Form Fields -->
  <app-text-input
    [formControl]="$any(registerForm.controls['name'])"
    [label]="'Ім\'я тваринки'"
    [disabled]="isUploading">
  </app-text-input>

  <app-text-input
    [formControl]="$any(registerForm.controls['description'])"
    [label]="'Опис тваринки'"
    [disabled]="isUploading">
  </app-text-input>

  <app-text-input
    [formControl]="$any(registerForm.controls['species'])"
    [label]="'Порода'"
    [disabled]="isUploading">
  </app-text-input>

  <app-text-input
    [formControl]="$any(registerForm.controls['age'])"
    [label]="'Вік'"
    [disabled]="isUploading">
  </app-text-input>

  <app-text-input
    [formControl]="$any(registerForm.controls['health'])"
    [label]="'Здоров\'я'"
    [disabled]="isUploading">
  </app-text-input>

  <!-- File Upload Section -->
  <div class="row mt-4">
    <div class="col-12">
      <h3>Фото тваринки</h3>

      <!-- Drop Zone -->
      <div ng2FileDrop
           [ngClass]="{'nv-file-over': hasBaseDropZoneOver}"
           (fileOver)="fileOverBase($event)"
           [uploader]="uploader"
           class="card bg-light p-4 text-center my-drop-zone mb-3">
        <i class="fa fa-upload fa-3x mb-2"></i>
        <p>Перетягніть фото сюди або</p>
        <label class="btn btn-primary">
          Оберіть файли
          <input type="file" ng2FileSelect [uploader]="uploader" multiple hidden>
        </label>
      </div>

      <!-- File Queue -->
      <div class="file-queue" *ngIf="uploader.queue?.length > 0">
        <h4>Файли для завантаження:</h4>
        <ul class="list-group mb-3">
          <li class="list-group-item d-flex justify-content-between align-items-center"
              *ngFor="let item of uploader.queue">
            <span>
              <strong>{{ item?.file?.name }}</strong>
              ({{ item?.file?.size/1024/1024 | number:'.2' }} MB)
            </span>
            <button class="btn btn-sm btn-danger"
                    (click)="item.remove()"
                    [disabled]="isUploading">
              <i class="fa fa-times"></i>
            </button>
          </li>
        </ul>

        <!-- Upload Progress -->
        <div *ngIf="isUploading" class="mb-3">
          <div class="progress">
            <div class="progress-bar progress-bar-striped progress-bar-animated"
                 role="progressbar"
                 [style.width]="uploader.progress + '%'">
              {{ uploader.progress }}%
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Validation Errors -->
  <div class="row" *ngIf="validationErrors">
    <div class="col-12">
      <div class="alert alert-danger">
        <ul class="mb-0">
          <li *ngFor="let error of validationErrors">
            {{ error }}
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Form Actions -->
  <div class="text-center mt-4">
    <button class="btn btn-success me-2"
            type="submit"
            [disabled]="!registerForm.valid || isUploading">
      <span *ngIf="!isUploading">Додати оголошення</span>
      <span *ngIf="isUploading">
        <i class="fa fa-spinner fa-spin"></i> Завантаження...
      </span>
    </button>
    <button class="btn btn-outline-secondary"
            type="button"
            (click)="cancel()"
            [disabled]="isUploading">
      Скасувати
    </button>
  </div>
</form>
